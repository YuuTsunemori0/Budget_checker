<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget Voyage</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            max-width: 400px;
            margin: auto;
        }
        input, button, select {
            display: block;
            margin: 10px 0;
            width: 100%;
            padding: 10px;
        }
        #total {
            font-weight: bold;
        }
        .expense-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Calculateur de Budget</h2>
        <input type="text" id="libelle" placeholder="Libell√©">
        <input type="number" id="montant" placeholder="Montant">
        <select id="categorie">
            <option value="üè†">Logement</option>
            <option value="üöï">Transport</option>
            <option value="üçî">Nourriture</option>
            <option value="üéüÔ∏è">Loisirs</option>
        </select>
        <button onclick="ajouterDepense()">Ajouter</button>
        <ul id="liste"></ul>
        <p>Total : <span id="total">0</span> ‚Ç¨</p>
        <button onclick="convertirDevise()">Convertir en JPY</button>
    </div>

    <script>
        let total = 0;
        let expenses = JSON.parse(localStorage.getItem("expenses")) || [];

        function ajouterDepense() {
            const libelle = document.getElementById("libelle").value;
            const montant = parseFloat(document.getElementById("montant").value);
            const categorie = document.getElementById("categorie").value;

            if (libelle && !isNaN(montant) && montant > 0) {
                expenses.push({ libelle, montant, categorie });
                localStorage.setItem("expenses", JSON.stringify(expenses));
                afficherDepenses();
            }
        }

        function afficherDepenses() {
            const liste = document.getElementById("liste");
            liste.innerHTML = "";
            total = 0;

            expenses.forEach((expense, index) => {
                const element = document.createElement("li");
                element.classList.add("expense-item");
                element.innerHTML = `${expense.categorie} ${expense.libelle} : ${expense.montant} ‚Ç¨ <button onclick="supprimerDepense(${index})">üóëÔ∏è</button>`;
                liste.appendChild(element);
                total += expense.montant;
            });
            document.getElementById("total").textContent = total;
        }

        function supprimerDepense(index) {
            expenses.splice(index, 1);
            localStorage.setItem("expenses", JSON.stringify(expenses));
            afficherDepenses();
        }

        function convertirDevise() {
            fetch("https://api.exchangerate-api.com/v4/latest/EUR")
                .then(response => response.json())
                .then(data => {
                    const taux = data.rates.JPY;
                    document.getElementById("total").textContent = (total * taux).toFixed(2) + " ¬•";
                })
                .catch(error => console.error("Erreur lors de la conversion", error));
        }

        document.addEventListener("DOMContentLoaded", afficherDepenses);
    </script>
</body>
</html>
